<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seattle Egg Prices - Find the Best Deals</title>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-TB94JESBJP"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-TB94JESBJP');
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            animation: fadeIn 0.5s ease-in;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .subtitle {
            font-size: 1.2em;
            opacity: 0.95;
            margin-bottom: 20px;
        }

        /* ZIP Code Selector */
        .zip-selector {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
        }

        .zip-selector label {
            color: white;
            font-size: 1.1em;
            font-weight: bold;
        }

        .zip-dropdown {
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            background: white;
            color: #333;
            cursor: pointer;
            min-width: 200px;
        }

        .last-updated {
            margin-top: 10px;
            padding: 5px 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 20px;
            display: inline-block;
            font-size: 0.9em;
            color: white;
        }

        /* No Selection Message */
        .no-selection {
            background: white;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin: 30px auto;
            max-width: 600px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .no-selection h2 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .no-selection p {
            color: #666;
            font-size: 1.1em;
        }

        /* Main Content (hidden by default) */
        .main-content {
            display: none;
        }

        .main-content.active {
            display: block;
        }

        /* Summary Cards */
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            animation: slideUp 0.5s ease-out;
        }

        .summary-card h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .summary-card .value {
            font-size: 2em;
            font-weight: bold;
            color: #333;
        }

        .summary-card .detail {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }

        /* Filter Controls */
        .filters {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .filter-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }

        .filter-group label {
            font-weight: 600;
            color: #333;
            margin-right: 10px;
            min-width: 100px;
            display: flex;
            align-items: center;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #667eea;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .filter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .filter-btn.active {
            background: #667eea;
            color: white;
        }

        .search-box {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            margin-bottom: 15px;
        }

        .search-box:focus {
            outline: none;
            border-color: #667eea;
        }

        /* Main Content Area */
        .content-area {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 30px;
        }

        /* Category Sidebar */
        .category-sidebar {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .category-header {
            font-size: 1.2em;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .category-item {
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .category-item:hover {
            background: #f8f8f8;
            transform: translateX(5px);
        }

        .category-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .category-icon {
            margin-right: 10px;
        }

        .category-count {
            background: rgba(0,0,0,0.1);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.85em;
        }

        /* Product Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .product-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .best-deal-badge {
            position: absolute;
            top: -5px;
            right: -30px;
            background: #ff6b6b;
            color: white;
            padding: 5px 40px;
            transform: rotate(45deg);
            font-size: 0.7em;
            font-weight: bold;
        }

        .store-name {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .product-name {
            font-size: 1.1em;
            color: #333;
            margin-bottom: 10px;
        }

        .product-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 15px 0;
            padding: 10px;
            background: #f8f8f8;
            border-radius: 8px;
        }

        .detail-item {
            display: flex;
            flex-direction: column;
        }

        .detail-label {
            font-size: 0.75em;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .detail-value {
            font-weight: bold;
            color: #333;
        }

        .price-main {
            font-size: 1.8em;
            font-weight: bold;
            color: #333;
            margin: 10px 0;
        }

        .price-per-dozen {
            color: #667eea;
            font-weight: 600;
        }

        .product-type {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.85em;
            margin-right: 5px;
            margin-top: 10px;
        }

        .type-conventional { background: #e0e0e0; color: #333; }
        .type-cage-free { background: #fff3cd; color: #856404; }
        .type-free-range { background: #d4edda; color: #155724; }
        .type-organic { background: #d1ecf1; color: #0c5460; }
        .type-pasture-raised { background: #f8d7da; color: #721c24; }

        /* Sort Controls */
        .sort-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            background: white;
            padding: 15px;
            border-radius: 10px;
        }

        .sort-select {
            padding: 8px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .content-area {
                grid-template-columns: 1fr;
            }
            
            .category-sidebar {
                position: static;
            }
            
            .summary-cards {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>🥚 Seattle Egg Price Tracker</h1>
            <p class="subtitle">Find the best egg prices in Seattle</p>
            
            <!-- ZIP Code Selector -->
            <div class="zip-selector">
                <label for="zipSelect">Select your area:</label>
                <select id="zipSelect" class="zip-dropdown">
                    <option value="">-- Choose ZIP Code --</option>
                    <option value="98102">Capitol Hill (98102)</option>
                    <option value="98105">U-District (98105)</option>
                </select>
            </div>
            
            <div class="last-updated" id="lastUpdated">Select a ZIP code to see prices</div>
        </header>

        <!-- No Selection Message -->
        <div id="noSelection" class="no-selection">
            <h2>👆 Select Your Neighborhood</h2>
            <p>Choose your ZIP code above to see egg prices from 5 major stores in your area.</p>
            <p style="margin-top: 15px; font-size: 0.9em;">Currently tracking: Safeway, QFC, Target, Trader Joe's, and Whole Foods</p>
        </div>

        <!-- Main Content (Hidden until ZIP selected) -->
        <div id="mainContent" class="main-content">
            <!-- Beta Feedback Banner -->
            <div style="background: linear-gradient(135deg, #ffd93d 0%, #ffb347 100%); padding: 20px; border-radius: 15px; text-align: center; margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                <h3 style="margin: 0 0 10px 0; color: #333;">🚧 Beta Version - Help Us Improve!</h3>
                <p style="margin: 0 0 15px 0; color: #333;">Which store should we add next?</p>
                <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                    <button onclick="showOtherStoreInput()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        Request Other Store
                    </button>
                </div>
                
                <div id="otherStoreInput" style="display: none; margin-top: 15px;">
                    <input type="text" id="customStoreName" placeholder="Enter store name (e.g., Costco, Fred Meyer)" 
                           style="padding: 10px; border: 2px solid #333; border-radius: 8px; width: 250px; margin-right: 10px;">
                    <button onclick="submitCustomStore()" 
                            style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;">
                        Submit Request
                    </button>
                    <button onclick="cancelCustomStore()" 
                            style="padding: 10px 20px; background: #ccc; color: #333; border: none; border-radius: 8px; cursor: pointer; margin-left: 5px;">
                        Cancel
                    </button>
                </div>
                
                <div id="voteMessage" style="margin-top: 15px; font-weight: bold; color: green; display: none;"></div>
            </div>

            <!-- Email Signup -->
            <div style="background: linear-gradient(135deg, #ffd93d 0%, #ffb347 100%); padding: 20px; border-radius: 15px; text-align: center; margin: 20px 0; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                <h3>📧 Get Weekly Price Updates</h3>
                <p>Be first to know when egg prices drop</p>
                <a href="https://docs.google.com/forms/d/e/1FAIpQLSdmZ-IgNl68iURYqfjSg3s7blc_sEqhq7svOM8SLkFOHKUI6w/viewform?usp=dialog" target="_blank" style="display: inline-block; padding: 10px 20px; background: #667eea; color: white; text-decoration: none; border-radius: 8px; font-weight: bold;">Subscribe for Updates</a>
            </div>

            <!-- Summary Cards -->
            <div class="summary-cards">
                <div class="summary-card">
                    <h3>Cheapest Dozen</h3>
                    <div class="value" id="cheapestPrice">--</div>
                    <div class="detail" id="cheapestDetail">--</div>
                </div>
                <div class="summary-card">
                    <h3>Average Price</h3>
                    <div class="value" id="averagePrice">--</div>
                    <div class="detail">Per dozen eggs</div>
                </div>
                <div class="summary-card">
                    <h3>Total Listings</h3>
                    <div class="value" id="totalListings">--</div>
                    <div class="detail" id="storeCount">--</div>
                </div>
                <div class="summary-card">
                    <h3>Best Store</h3>
                    <div class="value" id="bestStore">--</div>
                    <div class="detail" id="bestStoreDetail">--</div>
                </div>
            </div>

            <!-- Filters -->
            <div class="filters">
                <input type="text" class="search-box" id="searchBox" placeholder="🔍 Search by store, brand, or product name...">
                
                <div class="filter-group">
                    <label>Store:</label>
                    <button class="filter-btn active" data-filter="store" data-value="all">All Stores</button>
                    <button class="filter-btn" data-filter="store" data-value="Safeway">Safeway</button>
                    <button class="filter-btn" data-filter="store" data-value="Target">Target</button>
                    <button class="filter-btn" data-filter="store" data-value="QFC">QFC</button>
                    <button class="filter-btn" data-filter="store" data-value="Whole Foods">Whole Foods</button>
                    <button class="filter-btn" data-filter="store" data-value="Trader Joe's">Trader Joe's</button>
                </div>
                
                <div class="filter-group">
                    <label>Size:</label>
                    <button class="filter-btn active" data-filter="size" data-value="all">All Sizes</button>
                    <button class="filter-btn" data-filter="size" data-value="large">Large</button>
                    <button class="filter-btn" data-filter="size" data-value="extra-large">Extra Large</button>
                    <button class="filter-btn" data-filter="size" data-value="jumbo">Jumbo</button>
                    <button class="filter-btn" data-filter="size" data-value="medium">Medium</button>
                </div>
            </div>

            <!-- Sort Controls -->
            <div class="sort-controls">
                <div>
                    <label for="sortSelect">Sort by: </label>
                    <select id="sortSelect" class="sort-select">
                        <option value="total_low">Total Price: Low to High</option>
                        <option value="total_high">Total Price: High to Low</option>
                        <option value="price_low">Price Per Dozen: Low to High</option>
                        <option value="price_high">Price Per Dozen: High to Low</option>
                        <option value="store">Store Name</option>
                        <option value="type">Production Type</option>
                    </select>
                </div>
            </div>

            <!-- Main Content Area -->
            <div class="content-area">
                <!-- Category Sidebar -->
                <div class="category-sidebar">
                    <div class="category-header">Categories</div>
                    <div class="category-item active" data-category="all">
                        <span><span class="category-icon">📦</span> All Products</span>
                        <span class="category-count" id="countAll">0</span>
                    </div>
                    <div class="category-item" data-category="conventional">
                        <span><span class="category-icon">🥚</span> Conventional</span>
                        <span class="category-count" id="countConventional">0</span>
                    </div>
                    <div class="category-item" data-category="cage-free">
                        <span><span class="category-icon">🐓</span> Cage-Free</span>
                        <span class="category-count" id="countCageFree">0</span>
                    </div>
                    <div class="category-item" data-category="free-range">
                        <span><span class="category-icon">🌾</span> Free-Range</span>
                        <span class="category-count" id="countFreeRange">0</span>
                    </div>
                    <div class="category-item" data-category="organic">
                        <span><span class="category-icon">🌿</span> Organic</span>
                        <span class="category-count" id="countOrganic">0</span>
                    </div>
                    <div class="category-item" data-category="pasture-raised">
                        <span><span class="category-icon">🌳</span> Pasture-Raised</span>
                        <span class="category-count" id="countPastureRaised">0</span>
                    </div>
                </div>

                <!-- Products Grid -->
                <div class="products-grid" id="productsGrid">
                    <div class="loading">Loading egg prices...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data structure for multiple ZIP codes
        const eggDataByZip = {
            '98102': [
                // SAFEWAY - Capitol Hill Location
                {store: "Safeway", brand: "Eggland's Best", product: "Cage Free Large Brown Eggs", count: 18, price: 8.99, type: "cage-free", size: "large"},
                {store: "Safeway", brand: "Vital Farms", product: "Extra Large Pasture Raised Eggs", count: 12, price: 8.99, type: "pasture-raised", size: "extra-large"},
                {store: "Safeway", brand: "Vital Farms", product: "Pasture-Raised Eggs Large Eggs", count: 18, price: 12.49, type: "pasture-raised", size: "large"},
                {store: "Safeway", brand: "Eggland's Best", product: "Cage Free Large White Eggs", count: 12, price: 6.79, type: "cage-free", size: "large"},
                {store: "Safeway", brand: "Lucerne Farms", product: "Large Cage Free Eggs", count: 12, price: 5.99, type: "cage-free", size: "large"},
                {store: "Safeway", brand: "Lucerne Farms", product: "Cage Free Large Eggs", count: 18, price: 8.99, type: "cage-free", size: "large"},
                {store: "Safeway", brand: "Lucerne", product: "Cage Free Grade A Large Eggs", count: 60, price: 26.69, type: "cage-free", size: "large"},
                {store: "Safeway", brand: "O Organics", product: "Organic Eggs Large Brown", count: 12, price: 7.49, type: "organic", size: "large"},
                {store: "Safeway", brand: "Vital Farms", product: "Pasture Raised Large Eggs", count: 12, price: 8.99, type: "pasture-raised", size: "large"},
                {store: "Safeway", brand: "Lucerne", product: "Cage Free Jumbo Eggs", count: 12, price: 6.39, type: "cage-free", size: "jumbo"},
                {store: "Safeway", brand: "Lucerne Farms", product: "Cage Free Extra Large Eggs", count: 12, price: 6.19, type: "cage-free", size: "extra-large"},
                {store: "Safeway", brand: "Vital Farms", product: "Pasture Raised Extra Large Eggs", count: 12, price: 8.99, type: "pasture-raised", size: "extra-large"},
                {store: "Safeway", brand: "Happy Egg Co.", product: "Free Range Large Brown Eggs", count: 12, price: 7.49, type: "free-range", size: "large"},
                {store: "Safeway", brand: "Vital Farms", product: "Pasture-Raised Large Eggs", count: 12, price: 8.99, type: "pasture-raised", size: "large"},
                {store: "Safeway", brand: "Vital Farms Organic", product: "Pasture Raised Organic Large Grade A Eggs", count: 12, price: 10.49, type: "organic", size: "large"},
                {store: "Safeway", brand: "Eggland's Best", product: "Cage Free Large White Eggs", count: 24, price: 12.49, type: "cage-free", size: "large"},
                {store: "Safeway", brand: "Happy Egg Co.", product: "Free Range Organic Large Brown Eggs", count: 12, price: 8.99, type: "organic", size: "large"},
                {store: "Safeway", brand: "Happy Egg", product: "Free Range Large Brown Eggs", count: 18, price: 9.99, type: "free-range", size: "large"},
                {store: "Safeway", brand: "Eggland's Best", product: "Cage Free Large Brown Eggs", count: 12, price: 7.49, type: "cage-free", size: "large"},
                {store: "Safeway", brand: "O Organics", product: "Organic Eggs Large Brown", count: 18, price: 10.49, type: "organic", size: "large"},
                {store: "Safeway", brand: "Open Nature", product: "Brown Free Range Large Eggs", count: 12, price: 6.79, type: "free-range", size: "large"},
                {store: "Safeway", brand: "Happy Egg", product: "Free Range Organic Large Brown Eggs", count: 12, price: 8.99, type: "organic", size: "large"},
                {store: "Safeway", brand: "Open Nature", product: "Brown Free Range Large Eggs", count: 18, price: 8.99, type: "free-range", size: "large"},
                {store: "Safeway", brand: "O Organics", product: "Brown Pasture Raised Large Grade A Eggs", count: 12, price: 9.99, type: "pasture-raised", size: "large"},
                {store: "Safeway", brand: "Eggland's Best", product: "Cage Free Extra Large White Eggs", count: 12, price: 7.49, type: "cage-free", size: "extra-large"},
                {store: "Safeway", brand: "Lucerne Farms", product: "Cage Free Medium Grade A Eggs", count: 60, price: 25.69, type: "cage-free", size: "medium"},
                {store: "Safeway", brand: "Lucerne Farms", product: "Cage Free Large Eggs", count: 6, price: 3.99, type: "cage-free", size: "large"},
                {store: "Safeway", brand: "Eggland's Best", product: "USDA Organic Certified Large Brown Eggs", count: 12, price: 7.99, type: "organic", size: "large"},
                {store: "Safeway", brand: "Wilcox Family Farms", product: "Organic Large Omega Eggs", count: 12, price: 8.49, type: "organic", size: "large"},
                {store: "Safeway", brand: "Happy Egg", product: "Pasture Raised Large Brown Eggs", count: 12, price: 8.49, type: "pasture-raised", size: "large"},
                {store: "Safeway", brand: "Vital Farms", product: "Organic Pasture Raised Large Eggs", count: 18, price: 15.99, type: "organic", size: "large"},
                // TRADER JOE'S
                {store: "Trader Joe's", brand: "Carol's Eggs", product: "Grade A Cage-Free Large Brown Eggs", count: 12, price: 5.99, type: "cage-free", size: "large"},
                {store: "Trader Joe's", brand: "Trader Joe's", product: "Organic Pasture-Raised Large Brown Eggs", count: 12, price: 6.99, type: "organic", size: "large"},
                // QFC
                {store: "QFC", brand: "Happy Egg", product: "Free-Range Large Brown Eggs", count: 18, price: 8.99, type: "free-range", size: "large"},
                {store: "QFC", brand: "Vital Farms", product: "Pasture-Raised Large Brown Eggs", count: 12, price: 8.49, type: "pasture-raised", size: "large"},
                {store: "QFC", brand: "Vital Farms", product: "Pasture-Raised Large Brown Eggs", count: 18, price: 12.49, type: "pasture-raised", size: "large"},
                {store: "QFC", brand: "Nellie", product: "Free-Range Large Eggs", count: 12, price: 6.99, type: "free-range", size: "large"},
                {store: "QFC", brand: "QFC", product: "Cage-Free Large White Grade AA Eggs", count: 12, price: 2.89, type: "cage-free", size: "large"},
                {store: "QFC", brand: "Simple Truth", product: "Cage-Free Large Brown Eggs", count: 18, price: 8.79, type: "cage-free", size: "large"},
                {store: "QFC", brand: "QFC", product: "Cage-Free Large White Grade AA Eggs", count: 18, price: 4.29, type: "cage-free", size: "large"},
                {store: "QFC", brand: "Vital Farms", product: "Pasture-Raised Large Brown Organic Eggs", count: 12, price: 9.99, type: "pasture-raised", size: "large"},
                {store: "QFC", brand: "Simple Truth", product: "Natural Cage-Free Grade AA Large Brown Eggs", count: 12, price: 5.99, type: "cage-free", size: "large"},
                {store: "QFC", brand: "QFC", product: "Cage-Free Extra-Large White Grade AA Eggs", count: 12, price: 3.09, type: "cage-free", size: "extra-large"},
                {store: "QFC", brand: "Happy Egg", product: "Free-Range Brown Eggs", count: 12, price: 7.49, type: "free-range", size: "large"},
                {store: "QFC", brand: "Eggland's Best", product: "Cage-Free Large White Eggs", count: 18, price: 8.49, type: "cage-free", size: "large"},
                {store: "QFC", brand: "Simple Truth", product: "Organic Cage-Free Grade AA Large Brown Eggs", count: 12, price: 6.99, type: "cage-free", size: "large"},
                {store: "QFC", brand: "QFC", product: "Cage-Free Jumbo White Eggs", count: 12, price: 3.29, type: "cage-free", size: "jumbo"},
                {store: "QFC", brand: "Wilcox", product: "Free-Range Large Brown Organic Omega-3 Eggs", count: 12, price: 7.49, type: "free-range", size: "large"},
                {store: "QFC", brand: "Pete & Gerry", product: "Organic Free-Range Large Eggs", count: 12, price: 7.99, type: "free-range", size: "large"},
                {store: "QFC", brand: "Happy Egg", product: "Organic Free-Range Grade A Eggs", count: 18, price: 13.29, type: "free-range", size: "large"},
                {store: "QFC", brand: "Eggland's Best", product: "Cage-Free Large White Eggs", count: 12, price: 5.69, type: "cage-free", size: "large"},
                {store: "QFC", brand: "Simple Truth Organic", product: "Cage-Free Large Brown Eggs", count: 18, price: 10.29, type: "cage-free", size: "large"},
                {store: "QFC", brand: "Pete & Gerry", product: "Organic Free-Range Large Eggs", count: 18, price: 11.79, type: "free-range", size: "large"},
                {store: "QFC", brand: "Vital Farms", product: "Extra-Large Pasture-Raised Eggs", count: 12, price: 8.99, type: "pasture-raised", size: "extra-large"},
                {store: "QFC", brand: "Happy Egg", product: "Organic Free-Range Large Brown Eggs", count: 12, price: 8.99, type: "free-range", size: "large"},
                {store: "QFC", brand: "Nellie", product: "Free Range Large Eggs", count: 18, price: 10.29, type: "free-range", size: "large"},
                {store: "QFC", brand: "Simple Truth", product: "Kipster Cage-Free Large White Eggs", count: 12, price: 4.99, type: "cage-free", size: "large"},
                {store: "QFC", brand: "Wilcox", product: "Organic Cage-Free Extra-Large Brown Eggs", count: 6, price: 3.99, type: "cage-free", size: "extra-large"},
                {store: "QFC", brand: "Wilcox", product: "Pasture-Raised Large Brown Omega-3 Eggs", count: 12, price: 7.69, type: "pasture-raised", size: "large"},
                {store: "QFC", brand: "Kroger", product: "Extra-Large Grade AA White Eggs", count: 12, price: 3.09, type: "conventional", size: "extra-large"},
                {store: "QFC", brand: "Eggland's Best", product: "Cage-Free Large Brown Eggs", count: 12, price: 6.19, type: "cage-free", size: "large"},
                {store: "QFC", brand: "Eggland's Best", product: "Cage-Free Extra-Large White Eggs", count: 12, price: 6.19, type: "cage-free", size: "extra-large"},
                {store: "QFC", brand: "Eggland's Best", product: "Organic Large Brown Eggs", count: 12, price: 7.19, type: "organic", size: "large"},
                // TARGET
                {store: "Target", brand: "Vital Farms", product: "Pasture-Raised Grade A Large Eggs", count: 12, price: 6.89, type: "pasture-raised", size: "large"},
                {store: "Target", brand: "Happy Egg", product: "Large Brown Organic Free Range Grade A Eggs", count: 12, price: 7.79, type: "organic", size: "large"},
                {store: "Target", brand: "Good & Gather", product: "Cage-Free Grade A Large Brown Eggs", count: 12, price: 4.29, type: "cage-free", size: "large"},
                {store: "Target", brand: "Good & Gather", product: "Cage-Free Large White Grade A Eggs", count: 18, price: 4.99, type: "cage-free", size: "large"},
                {store: "Target", brand: "Good & Gather", product: "Cage-Free Large White Fresh Grade A Eggs", count: 12, price: 2.89, type: "cage-free", size: "large"},
                {store: "Target", brand: "Vital Farms", product: "Organic Pasture-Raised Grade A Large Eggs", count: 12, price: 9.79, type: "organic", size: "large"},
                {store: "Target", brand: "Good & Gather", product: "Organic Cage-Free Grade A Large Brown Eggs", count: 12, price: 5.69, type: "organic", size: "large"},
                {store: "Target", brand: "Vital Farms", product: "Pasture-Raised Large Eggs", count: 18, price: 9.99, type: "pasture-raised", size: "large"},
                {store: "Target", brand: "Happy Egg", product: "Large Brown Grade A Free Range Brown Eggs", count: 12, price: 7.29, type: "free-range", size: "large"},
                // WHOLE FOODS
                {store: "Whole Foods", brand: "Wilcox Farm", product: "Large Grade AA Brown Eggs", count: 12, price: 7.09, type: "conventional", size: "large"},
                {store: "Whole Foods", brand: "Pete & Gerry's", product: "Large Grade A Eggs", count: 12, price: 6.99, type: "conventional", size: "large"},
                {store: "Whole Foods", brand: "Vital Farms", product: "Large Grade A Eggs", count: 12, price: 7.99, type: "conventional", size: "large"},
                {store: "Whole Foods", brand: "Vital Farms", product: "Extra-Large Grade A Eggs", count: 12, price: 8.49, type: "conventional", size: "extra-large"},
                {store: "Whole Foods", brand: "Vital Farms", product: "Organic Large Grade A Eggs", count: 18, price: 12.99, type: "organic", size: "large"},
                {store: "Whole Foods", brand: "Pete & Gerry's", product: "Large Grade A Eggs", count: 18, price: 9.99, type: "organic", size: "large"},
                {store: "Whole Foods", brand: "Vital Farms", product: "Organic Large Grade A Eggs", count: 12, price: 9.99, type: "organic", size: "large"},
                {store: "Whole Foods", brand: "Vital Farms", product: "Organic Grade A Extra-Large Eggs", count: 12, price: 10.03, type: "organic", size: "extra-large"},
                {store: "Whole Foods", brand: "Pete & Gerry's", product: "Organic Brown Large Grade A Eggs", count: 12, price: 7.99, type: "organic", size: "large"},
                {store: "Whole Foods", brand: "Organic Valley", product: "Organic Brown Large Grade A Eggs", count: 12, price: 7.69, type: "organic", size: "large"},
                {store: "Whole Foods", brand: "Organic Valley", product: "Organic Grade A Large Brown Eggs", count: 18, price: 8.25, type: "organic", size: "large"},
                {store: "Whole Foods", brand: "Alexandre Family Farms", product: "Organic Jumbo Grade AA Eggs", count: 6, price: 6.49, type: "organic", size: "jumbo"},
                {store: "Whole Foods", brand: "Pete & Gerry's", product: "Pasture Raised Grade A Brown Eggs", count: 18, price: 8.99, type: "pasture-raised", size: "large"},
                {store: "Whole Foods", brand: "365 by Whole Foods Market", product: "Large White Grade A Eggs", count: 12, price: 5.49, type: "conventional", size: "large"},
                {store: "Whole Foods", brand: "365 by Whole Foods Market", product: "Large Brown Grade A Eggs", count: 12, price: 5.49, type: "conventional", size: "large"},
                {store: "Whole Foods", brand: "365 by Whole Foods Market", product: "Extra-Large Brown Grade A Eggs", count: 12, price: 5.79, type: "conventional", size: "extra-large"},
                {store: "Whole Foods", brand: "365 by Whole Foods Market", product: "Extra-Large Grade A Brown Eggs", count: 12, price: 6.79, type: "organic", size: "extra-large"},
                {store: "Whole Foods", brand: "365 by Whole Foods Market", product: "Organic Omega-3 Large Brown Grade A Eggs", count: 12, price: 6.99, type: "organic", size: "large"}
            ],
            '98105': [
                // U-District data will go here when you collect it
                // For now, leaving it empty to show "Coming Soon" message
            ]
        };

        let currentZip = '';
        let currentData = [];
        let currentFilters = {
            store: 'all',
            size: 'all',
            category: 'all',
            search: ''
        };
        let currentSort = 'total_low';

        // Handle ZIP code selection
        document.getElementById('zipSelect').addEventListener('change', function(e) {
            currentZip = e.target.value;
            
            if (currentZip) {
                // Hide no selection message, show main content
                document.getElementById('noSelection').style.display = 'none';
                document.getElementById('mainContent').classList.add('active');
                
                // Update subtitle
                document.querySelector('.subtitle').textContent = `Find the best egg prices in ZIP ${currentZip}`;
                
                // Load data for selected ZIP
                loadDataForZip(currentZip);
            } else {
                // Show no selection message, hide main content
                document.getElementById('noSelection').style.display = 'block';
                document.getElementById('mainContent').classList.remove('active');
                document.querySelector('.subtitle').textContent = 'Find the best egg prices in Seattle';
                currentData = [];
            }
        });

        function loadDataForZip(zip) {
            currentData = eggDataByZip[zip] || [];
            
            if (currentData.length === 0) {
                document.getElementById('productsGrid').innerHTML = `
                    <div style="grid-column: 1/-1; background: white; padding: 40px; text-align: center; border-radius: 15px;">
                        <h3>Coming Soon!</h3>
                        <p>We're still collecting data for this area. Check back soon!</p>
                    </div>
                `;
                // Clear summary cards
                document.getElementById('cheapestPrice').textContent = '--';
                document.getElementById('cheapestDetail').textContent = '--';
                document.getElementById('averagePrice').textContent = '--';
                document.getElementById('totalListings').textContent = '0';
                document.getElementById('storeCount').textContent = 'No data yet';
                document.getElementById('bestStore').textContent = '--';
                document.getElementById('bestStoreDetail').textContent = '--';
                updateCategoryCounts();
                return;
            }
            
            // Calculate price per dozen
            currentData.forEach(item => {
                item.pricePerDozen = Math.round((item.price / item.count) * 12 * 100) / 100;
                item.pricePerEgg = Math.round((item.price / item.count) * 1000) / 1000;
            });
            
            // Update everything
            updateSummaryCards();
            updateCategoryCounts();
            renderProducts();
            
            // Update last updated time
            const now = new Date();
            document.getElementById('lastUpdated').textContent = 
                `Last updated: ${now.toLocaleDateString()} ${now.toLocaleTimeString()}`;
        }

        function updateSummaryCards() {
            if (currentData.length === 0) return;
            
            // Find cheapest
            const cheapest = currentData.reduce((min, item) => 
                item.pricePerDozen < min.pricePerDozen ? item : min);
            
            document.getElementById('cheapestPrice').textContent = `$${cheapest.pricePerDozen}`;
            document.getElementById('cheapestDetail').textContent = 
                `${cheapest.store} - ${cheapest.brand}`;

            // Calculate average
            const average = currentData.reduce((sum, item) => sum + item.pricePerDozen, 0) / currentData.length;
            document.getElementById('averagePrice').textContent = `$${average.toFixed(2)}`;

            // Total listings
            document.getElementById('totalListings').textContent = currentData.length;
            const uniqueStores = [...new Set(currentData.map(item => item.store))];
            document.getElementById('storeCount').textContent = `From ${uniqueStores.length} stores`;

            // Best store
            const storeAverages = {};
            currentData.forEach(item => {
                if (!storeAverages[item.store]) {
                    storeAverages[item.store] = { total: 0, count: 0 };
                }
                storeAverages[item.store].total += item.pricePerDozen;
                storeAverages[item.store].count++;
            });

            let bestStore = null;
            let bestAverage = Infinity;
            for (const [store, storeData] of Object.entries(storeAverages)) {
                const avg = storeData.total / storeData.count;
                if (avg < bestAverage) {
                    bestAverage = avg;
                    bestStore = store;
                }
            }

            document.getElementById('bestStore').textContent = bestStore;
            document.getElementById('bestStoreDetail').textContent = 
                `Avg: $${bestAverage.toFixed(2)}/dozen`;
        }

        function updateCategoryCounts() {
            const counts = {
                all: 0,
                conventional: 0,
                'cage-free': 0,
                'free-range': 0,
                organic: 0,
                'pasture-raised': 0
            };

            // Only count items that match current filters
            const filteredData = currentData.filter(item => {
                if (currentFilters.store !== 'all' && item.store !== currentFilters.store) return false;
                if (currentFilters.size !== 'all' && item.size !== currentFilters.size) return false;
                if (currentFilters.search && !searchMatch(item, currentFilters.search)) return false;
                return true;
            });

            // Count the filtered items by category
            filteredData.forEach(item => {
                counts[item.type]++;
            });
            counts.all = filteredData.length;

            document.getElementById('countAll').textContent = counts.all;
            document.getElementById('countConventional').textContent = counts.conventional;
            document.getElementById('countCageFree').textContent = counts['cage-free'];
            document.getElementById('countFreeRange').textContent = counts['free-range'];
            document.getElementById('countOrganic').textContent = counts.organic;
            document.getElementById('countPastureRaised').textContent = counts['pasture-raised'];
        }

        function filterProducts() {
            return currentData.filter(item => {
                if (currentFilters.store !== 'all' && item.store !== currentFilters.store) return false;
                if (currentFilters.size !== 'all' && item.size !== currentFilters.size) return false;
                if (currentFilters.category !== 'all' && item.type !== currentFilters.category) return false;
                if (currentFilters.search && !searchMatch(item, currentFilters.search)) return false;
                return true;
            });
        }

        function searchMatch(item, search) {
            const searchLower = search.toLowerCase();
            return item.store.toLowerCase().includes(searchLower) ||
                   item.brand.toLowerCase().includes(searchLower) ||
                   item.product.toLowerCase().includes(searchLower);
        }

        function sortProducts(products) {
            const sorted = [...products];
            switch (currentSort) {
                case 'total_low':
                    return sorted.sort((a, b) => a.price - b.price);
                case 'total_high':
                    return sorted.sort((a, b) => b.price - a.price);
                case 'price_low':
                    return sorted.sort((a, b) => a.pricePerDozen - b.pricePerDozen);
                case 'price_high':
                    return sorted.sort((a, b) => b.pricePerDozen - a.pricePerDozen);
                case 'store':
                    return sorted.sort((a, b) => a.store.localeCompare(b.store));
                case 'type':
                    return sorted.sort((a, b) => a.type.localeCompare(b.type));
                default:
                    return sorted;
            }
        }

        function renderProducts() {
            const filtered = filterProducts();
            const sorted = sortProducts(filtered);
            const grid = document.getElementById('productsGrid');

            if (sorted.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; padding: 40px; color: white;">
                        No products found matching your filters.
                    </div>
                `;
                return;
            }

            // Find best deal in each category
            const bestDeals = {};
            sorted.forEach(item => {
                if (!bestDeals[item.type] || item.pricePerDozen < bestDeals[item.type].pricePerDozen) {
                    bestDeals[item.type] = item;
                }
            });

            grid.innerHTML = sorted.map(item => {
                const isBestDeal = bestDeals[item.type] === item;
                return `
                    <div class="product-card">
                        ${isBestDeal ? '<div class="best-deal-badge">BEST DEAL</div>' : ''}
                        <div class="store-name">${item.store}</div>
                        <div class="product-name">${item.brand} - ${item.product}</div>
                        <div class="price-main">$${item.price.toFixed(2)}</div>
                        <div class="product-details">
                            <div class="detail-item">
                                <span class="detail-label">Count</span>
                                <span class="detail-value">${item.count} eggs</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Size</span>
                                <span class="detail-value">${item.size}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Per Dozen</span>
                                <span class="detail-value price-per-dozen">$${item.pricePerDozen}</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Per Egg</span>
                                <span class="detail-value">$${item.pricePerEgg.toFixed(3)}</span>
                            </div>
                        </div>
                        <span class="product-type type-${item.type}">${item.type.replace('-', ' ')}</span>
                    </div>
                `;
            }).join('');
        }

        // Attach event listeners
        function attachEventListeners() {
            // Store filters
            document.querySelectorAll('[data-filter="store"]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('[data-filter="store"]').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    currentFilters.store = e.target.dataset.value;
                    renderProducts();
                    updateCategoryCounts();
                });
            });

            // Size filters
            document.querySelectorAll('[data-filter="size"]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('[data-filter="size"]').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    currentFilters.size = e.target.dataset.value;
                    renderProducts();
                    updateCategoryCounts();
                });
            });

            // Category sidebar
            document.querySelectorAll('.category-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    document.querySelectorAll('.category-item').forEach(i => i.classList.remove('active'));
                    e.currentTarget.classList.add('active');
                    currentFilters.category = e.currentTarget.dataset.category;
                    renderProducts();
                });
            });

            // Search box
            document.getElementById('searchBox').addEventListener('input', (e) => {
                currentFilters.search = e.target.value;
                renderProducts();
                updateCategoryCounts();
            });

            // Sort select
            document.getElementById('sortSelect').addEventListener('change', (e) => {
                currentSort = e.target.value;
                renderProducts();
            });
        }

        // Store request functions
        function showOtherStoreInput() {
            document.getElementById('otherStoreInput').style.display = 'block';
            document.getElementById('customStoreName').focus();
        }

        function cancelCustomStore() {
            document.getElementById('otherStoreInput').style.display = 'none';
            document.getElementById('customStoreName').value = '';
        }

        function submitCustomStore() {
            const storeName = document.getElementById('customStoreName').value.trim();
            
            if (!storeName) {
                const messageDiv = document.getElementById('voteMessage');
                messageDiv.textContent = 'Please enter a store name';
                messageDiv.style.display = 'block';
                messageDiv.style.color = 'red';
                setTimeout(() => {
                    messageDiv.style.display = 'none';
                }, 3000);
                return;
            }
            
            // Track in Google Analytics
            if (typeof gtag !== 'undefined') {
                gtag('event', 'custom_store_request', {
                    'store_name': storeName,
                    'event_category': 'user_engagement',
                    'event_label': storeName
                });
            }
            
            // Show confirmation
            const messageDiv = document.getElementById('voteMessage');
            messageDiv.textContent = `Thanks for suggesting ${storeName}!`;
            messageDiv.style.display = 'block';
            messageDiv.style.color = 'green';
            
            // Clear and hide the input
            document.getElementById('customStoreName').value = '';
            document.getElementById('otherStoreInput').style.display = 'none';
            
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 3000);
        }

        // Initialize when page loads
        window.addEventListener('DOMContentLoaded', function() {
            attachEventListeners();
            
            // Allow submitting with Enter key
            const customInput = document.getElementById('customStoreName');
            if (customInput) {
                customInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        submitCustomStore();
                    }
                });
            }
        });
    </script>
</body>
</html>



























